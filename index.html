<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ß–µ–º–ø—ñ–æ–Ω–∞—Ç –£–∫—Ä–∞—ó–Ω–∏ —Å–µ—Ä–µ–¥ –ï–ª–µ–∫—Ç—Ä–∏–∫—ñ–≤</title>
<style>
:root {
  --green-main: #009E4F;
  --green-dark: #007C3E;
  --green-light: #E6F4EC;
  --text-color: #1a1a1a;
  --gold: #FFD700;
  --silver: #C0C0C0;
  --bronze: #CD7F32;
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  margin: 0;
  padding: 0;
  background-color: var(--green-light);
  color: var(--text-color);
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
}

header {
  background-color: var(--green-main);
  width: 100%;
  padding: 20px 0;
  text-align: center;
  color: white;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  position: relative;
}

.logo-container {
  position: absolute;
  top: 10px;
  left: 20px;
}

.logo-container img {
  height: 60px;
}

h1 {
  margin: 0;
  font-size: 2rem;
  padding: 0 80px;
}

.sub-title {
  display: block; /* –∑–∞–≤–∂–¥–∏ –Ω–æ–≤–∏–π —Ä—è–¥–æ–∫ */
  font-size: 2rem;
  font-weight: bold;
  margin-top: 4px;
  color: #FFD700; /* –º–æ–∂–Ω–∞ –∑–º—ñ–Ω–∏—Ç–∏ –∫–æ–ª—ñ—Ä */
}

table {
  margin-top: 30px;
  width: 90%;
  max-width: 1000px;
  border-collapse: collapse;
  background: white;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  transition: all 0.5s ease;
}

th, td {
  padding: 14px;
  text-align: center;
}

th {
  background-color: var(--green-dark);
  color: white;
  text-transform: uppercase;
  font-size: 0.85rem;
}

tr:nth-child(even) { background-color: #f9f9f9; }
tr.updated { background-color: #ccf5da !important; }

tbody tr { transition: transform 0.5s ease; position: relative; }

tr.medal {
  opacity: 0;
  transition: background-color 1s ease, opacity 1s ease;
}

tr.medal.show {
  opacity: 1;
}

tr.gold { background-color: var(--gold) !important; }
tr.silver { background-color: var(--silver) !important; }
tr.bronze { background-color: var(--bronze) !important; }

.controls {
  margin-top: 20px;
  display: flex;
  gap: 15px;
  flex-wrap: wrap;
  justify-content: center;
}

button {
  background-color: var(--green-main);
  color: white;
  border: none;
  padding: 12px 24px;
  font-size: 1rem;
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

button:hover { background-color: var(--green-dark); }

.checkbox-container {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 1rem;
  margin-top: 10px;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å */
@media (max-width: 900px) {
  h1 { font-size: 1.6rem; padding: 0 60px; }
  .sub-title { font-size: 1.3rem; }
  th, td { padding: 10px; }
}

@media (max-width: 600px) {
  h1 {
    font-size: 1.3rem;
    padding: 0 40px;
    margin-top: 50px; /* —â–æ–± –ª–æ–≥–æ –Ω–µ –Ω–∞—Å—É–≤–∞–ª–æ—Å—è */
  }

  .sub-title { font-size: 1.3rem; }

  .logo-container img { height: 40px; }

  th, td { padding: 6px; font-size: 0.75rem; }

  table {
    width: 100%;
    margin-top: 20px;
    font-size: 0.75rem;
    display: block;
    overflow-x: auto;
  }

  .controls { flex-direction: column; gap: 10px; }

  button { padding: 10px 16px; font-size: 0.9rem; }
}
#leaderboard td:nth-child(2) {
  font-weight: bold;
}
</style>
</head>
<body>
<header>
  <div class="logo-container">
    <img src="https://workspace.digital/wp-content/uploads/2017/01/schneider-logo-white-400.png" alt="Schneider Electric Logo">
  </div>
  <h1>
    –ß–µ–º–ø—ñ–æ–Ω–∞—Ç –£–∫—Ä–∞—ó–Ω–∏ —Å–µ—Ä–µ–¥ –ï–ª–µ–∫—Ç—Ä–∏–∫—ñ–≤
    <span class="sub-title">Schneider Electric Cup</span>
  </h1>
</header>

<table id="leaderboard">
  <thead>
    <tr>
      <th>–ú—ñ—Å—Ü–µ</th>
      <th>–ö–æ–º–∞–Ω–¥–∞</th>
      <th>–ó–∞–≤–¥–∞–Ω–Ω—è 1</th>
      <th>–ó–∞–≤–¥–∞–Ω–Ω—è 2</th>
      <th>–ó–∞–≤–¥–∞–Ω–Ω—è 3</th>
      <th>–ó–∞–≤–¥–∞–Ω–Ω—è 4</th>
      <th>–ó–∞–≥–∞–ª—å–Ω–∏–π –±–∞–ª</th>
    </tr>
  </thead>
  <tbody>
    <tr><td colspan="7">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</td></tr>
  </tbody>
</table>

<div class="controls">
  <button onclick="loadData()">üîÑ –û–Ω–æ–≤–∏—Ç–∏ –¥–∞–Ω—ñ</button>
  <button onclick="exportTableToExcel()">‚¨áÔ∏è –ï–∫—Å–ø–æ—Ä—Ç –≤ Excel</button>
  <label class="checkbox-container">
    <input type="checkbox" id="showMedals"> –†–µ–∑—É–ª—å—Ç–∞—Ç–∏
  </label>
</div>

<script>
const sheetId = "10UH1iymC0dHJiILR5fqB6CTKVMfwew-XlYrHZMfxFV4";
const sheetName = "Sheet1";
const url = `https://opensheet.elk.sh/${sheetId}/${sheetName}`;

let showMedals = false;

const checkbox = document.getElementById('showMedals');
checkbox.addEventListener('change', (e) => {
  showMedals = e.target.checked;
  loadData();
});

function getRowKey(row) { return row["–ö–æ–º–∞–Ω–¥–∞"]; }

function capturePositions() {
  const rows = document.querySelectorAll("#leaderboard tbody tr");
  const map = new Map();
  rows.forEach(row => {
    const key = row.dataset.key;
    map.set(key, row.getBoundingClientRect().top);
  });
  return map;
}

function animateChanges(beforePositions) {
  const rows = document.querySelectorAll("#leaderboard tbody tr");
  rows.forEach(row => {
    const key = row.dataset.key;
    const oldTop = beforePositions.get(key);
    const newTop = row.getBoundingClientRect().top;
    const deltaY = oldTop - newTop;

    if (deltaY !== 0) {
      row.style.transform = `translateY(${deltaY}px)`;
      requestAnimationFrame(() => {
        row.style.transition = "transform 0.5s ease";
        row.style.transform = "translateY(0)";
      });
    }
  });
}

function loadData() {
  fetch(url)
    .then(res => res.json())
    .then(data => {
      const tbody = document.querySelector("#leaderboard tbody");
      const positionsBefore = capturePositions();
      tbody.innerHTML = "";

      data.sort((a, b) => parseInt(b["–ó–∞–≥–∞–ª—å–Ω–∏–π –±–∞–ª"]) - parseInt(a["–ó–∞–≥–∞–ª—å–Ω–∏–π –±–∞–ª"]));

      data.forEach((row,index)=>{
        const tr = document.createElement("tr");
        tr.dataset.key = getRowKey(row);

        let medal = index + 1;
        tr.classList.remove("gold","silver","bronze","medal","show");

        if(showMedals && index<3){
          tr.classList.add("medal");
          if(index===0) tr.classList.add("gold","show");
          else if(index===1) tr.classList.add("silver","show");
          else if(index===2) tr.classList.add("bronze","show");

          medal = index===0?"ü•á":index===1?"ü•à":index===2?"ü•â":medal;
        }

        tr.innerHTML = `<td>${medal}</td>
          <td>${row["–ö–æ–º–∞–Ω–¥–∞"]}</td>
          <td>${row["–ó–∞–≤–¥–∞–Ω–Ω—è 1"]}</td>
          <td>${row["–ó–∞–≤–¥–∞–Ω–Ω—è 2"]}</td>
          <td>${row["–ó–∞–≤–¥–∞–Ω–Ω—è 3"]}</td>
          <td>${row["–ó–∞–≤–¥–∞–Ω–Ω—è 4"]}</td>
          <td>${row["–ó–∞–≥–∞–ª—å–Ω–∏–π –±–∞–ª"]}</td>`;
        tbody.appendChild(tr);
      });

      animateChanges(positionsBefore);
    })
    .catch(error => {
      console.error("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö:", error);
      const tbody = document.querySelector("#leaderboard tbody");
      tbody.innerHTML = "<tr><td colspan='7'>–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö</td></tr>";
    });
}

function exportTableToExcel() {
  const table = document.getElementById("leaderboard");
  const html = table.outerHTML.replace(/ /g, '%20');
  const url = 'data:application/vnd.ms-excel,' + html;
  const link = document.createElement('a');
  link.href = url;
  link.download = 'turnirna-tablytsia.xls';
  link.click();
}

window.onload = ()=>{
  loadData();
  setInterval(loadData,10000);
};
</script>
</body>
</html>

